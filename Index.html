<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>App CRISMAR</title>
<style>
body{margin:0;font-family:Arial;background:#000;color:#fff;display:flex;flex-direction:column;height:100vh;}
header{background:#111;padding:15px;display:flex;align-items:center;gap:10px;border-bottom:2px solid #0af;}
header h1{margin:0;color:#0af;font-size:22px;}
#menu{display:flex;gap:10px;justify-content:center;background:#111;border-bottom:2px solid #0af;}
#menu button{flex:1;padding:10px;border:none;border-radius:8px;background:#0af;color:#000;font-weight:bold;cursor:pointer;}
.screen{flex:1;overflow-y:auto;padding:15px;display:none;}
.screen.active{display:block;}
.message{max-width:75%;padding:12px;margin:8px 0;border-radius:10px;line-height:1.4;word-break:break-word;white-space:pre-wrap;}
.bot{background:#111;border-left:3px solid #0af;}
.user{background:#0a0a0a;border-right:3px solid #0af;margin-left:auto;}
.input-area{display:flex;padding:10px;background:#111;border-top:2px solid #0af;}
input{flex:1;padding:12px;border:none;border-radius:8px;background:#222;color:#fff;font-size:16px;outline:none;}
button.send{padding:12px 18px;margin-left:10px;border:none;border-radius:8px;background:#0af;color:#000;font-weight:bold;cursor:pointer;}
.btn-group{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px;}
.quick{background:#111;border:1px solid rgba(255,255,255,0.1);padding:6px 10px;border-radius:6px;cursor:pointer;color:#ddd;}
input[type=number]{width:80px;}
select{padding:6px;border-radius:6px;background:#222;color:#fff;border:none;margin-left:5px;}
#whatsappBtn{display:none;padding:12px 18px;margin-top:10px;border:none;border-radius:8px;background:#25D366;color:#000;font-weight:bold;cursor:pointer;}
</style>
</head>
<body>

<header>
<h1>ðŸ¤– CRISMAR App</h1>
</header>

<div id="menu">
<button onclick="showScreen('home')">Home</button>
<button onclick="showScreen('orcamento')">OrÃ§amento</button>
<button onclick="showScreen('vidros')">Tipos de Vidro</button>
<button onclick="showScreen('contato')">Contato</button>
<button onclick="showScreen('chat')">Chatbot</button>
</div>

<!-- Home -->
<div id="home" class="screen active">
<h2>Bem-vindo Ã  CRISMAR!</h2>
<p>O melhor lugar para vidros, portas, janelas e box sob medida.</p>
<img src="" alt="Logo CRISMAR" style="width:200px;display:block;margin:15px auto;">
</div>

<!-- OrÃ§amento -->
<div id="orcamento" class="screen">
<h2>Calcular OrÃ§amento</h2>
<p>Informe a medida em centÃ­metros:</p>
<label>Largura: <input type="number" id="largura" placeholder="cm"></label>
<label>Altura: <input type="number" id="altura" placeholder="cm"></label><br><br>
<label>Tipo de vidro: 
<select id="tipoVidro">
<option value="temperado">Temperado</option>
<option value="comum">Comum</option>
<option value="fumÃª">FumÃª</option>
<option value="verde">Verde</option>
<option value="espelho">Espelho</option>
<option value="laminado">Laminado</option>
<option value="box">Box</option>
</select>
</label><br><br>
<button onclick="calcularPreco()">Calcular</button>
<p id="resultadoPreco"></p>
<button id="whatsappBtn">ðŸ“² Enviar para WhatsApp</button>
</div>

<!-- Tipos de Vidro -->
<div id="vidros" class="screen">
<h2>Tipos de Vidro</h2>
<ul>
<li><strong>Temperado:</strong> Seguro, resistente e durÃ¡vel.</li>
<li><strong>Comum:</strong> EconÃ´mico e prÃ¡tico.</li>
<li><strong>FumÃª:</strong> Escuro, protege do sol e privacidade.</li>
<li><strong>Verde:</strong> Visual moderno e elegante.</li>
<li><strong>Espelho:</strong> DecoraÃ§Ã£o e ampliaÃ§Ã£o de ambientes.</li>
<li><strong>Laminado:</strong> Alta seguranÃ§a e proteÃ§Ã£o extra.</li>
<li><strong>Box:</strong> Vidro especial para banheiros, sob medida.</li>
</ul>
</div>

<!-- Contato -->
<div id="contato" class="screen">
<h2>Contato</h2>
<p>ðŸ“ž Telefone/WhatsApp: <strong>21 98371-5779</strong></p>
<button onclick="window.open('https://instagram.com/crismar_instalador_vidros','_blank')">
ðŸ“¸ Instagram: @crismar_instalador_vidros
</button>
</div>

<!-- Chatbot -->
<div id="chat" class="screen">
<h2>CRISMAR BOT</h2>
<div id="chatContainer"></div>
<div class="input-area">
<input id="inputChat" placeholder="Digite sua dÃºvida..." autocomplete="off">
<button class="send" onclick="sendMessage()">Enviar</button>
</div>
</div>

<script>
// NavegaÃ§Ã£o entre telas
function showScreen(id){
  document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

// PreÃ§os
const pricePerM2={temperado:450,comum:260,fumÃª:500,verde:380,espelho:600,laminado:720,box:480};

// FunÃ§Ã£o calcular orÃ§amento
function calcularPreco(){
  const w=parseFloat(document.getElementById('largura').value);
  const h=parseFloat(document.getElementById('altura').value);
  const tipo=document.getElementById('tipoVidro').value;
  const resultado=document.getElementById('resultadoPreco');
  if(!w || !h){alert('Informe largura e altura!'); return;}
  const area=(w/100)*(h/100);
  const total=(area*pricePerM2[tipo]).toFixed(2);
  resultado.innerHTML=`PreÃ§o aproximado: R$ ${total}`;
  
  // BotÃ£o WhatsApp
  const whatsappBtn=document.getElementById('whatsappBtn');
  whatsappBtn.style.display='inline-block';
  whatsappBtn.onclick=()=>{
    const msg=`OlÃ¡, CRISMAR! Solicitei um orÃ§amento:\nTipo de vidro: ${tipo.toUpperCase()}\nLargura: ${w} cm\nAltura: ${h} cm\nPreÃ§o: R$ ${total}`;
    const link=`https://api.whatsapp.com/send?phone=5521983715779&text=${encodeURIComponent(msg)}`;
    window.open(link,'_blank');
  };
}

// Chatbot ultra completo
const chatContainer=document.getElementById('chatContainer');
const inputChat=document.getElementById('inputChat');

function addMessage(text,type='bot'){
  const div=document.createElement('div');
  div.classList.add('message',type);
  div.innerHTML=text;
  chatContainer.appendChild(div);
  chatContainer.scrollTop=chatContainer.scrollHeight;
}

function showTyping(cb,time=700){
  const div=document.createElement('div');
  div.className='message bot';
  div.innerHTML='Digitando...';
  chatContainer.appendChild(div);
  chatContainer.scrollTop=chatContainer.scrollHeight;
  setTimeout(()=>{chatContainer.removeChild(div);cb();},time);
}

function findMeasurement(text){
  const re=/(\d{1,4})\s*(?:cm)?\s*[xÃ—*por]{1,4}\s*(\d{1,4})\s*(?:cm)?/i;
  const m=text.match(re);
  if(m)return {w:parseInt(m[1],10),h:parseInt(m[2],10)};
  return null;
}

const respostas={
  saudacao:["OlÃ¡! Sou o CRISMAR BOT ðŸ¤–. Em que posso ajudar hoje?","Oi! Me diga sua dÃºvida sobre vidro, box ou porta.","E aÃ­! Quer orÃ§amento ou informaÃ§Ã£o?"],
  preco:["Para calcular o preÃ§o, me envie largura x altura em centÃ­metros. Ex: 'temperado 200x120'.","Envie as medidas em cm e o tipo de vidro.","Posso calcular o preÃ§o certinho se me mandar as medidas em centÃ­metros."],
  tipos_vidro:["Trabalhamos com temperado, comum, fumÃª, verde, espelho e laminado.","Vidro temperado Ã© seguro, comum Ã© econÃ´mico, espelho para decoraÃ§Ã£o, laminado para seguranÃ§a extra."],
  box:["Instalamos box sob medida, me envie as medidas em cm.","Box padrÃ£o ou premium, vocÃª decide. Qual a largura e altura?"],
  porta:["Fazemos portas de vidro e janelas sob medida.","Temos portas temperadas, comuns e espelhadas."],
  contato:["Nosso WhatsApp e telefone Ã© 21 98371-5779 ðŸ“ž","Pode chamar no WhatsApp da CRISMAR: 21 98371-5779"],
  fallback:["NÃ£o entendi, pode explicar de outra forma?","Desculpe, nÃ£o compreendi, tente enviar tipo de vidro e medidas."]
};

const mapaRespostas={
  "oi":"saudacao","ola":"saudacao","olÃ¡":"saudacao",
  "preco":"preco","preÃ§o":"preco","valor":"preco","quanto":"preco","medida":"preco","cm":"preco",
  "vidro":"tipos_vidro","temperado":"tipos_vidro","comum":"tipos_vidro","espelho":"tipos_vidro","fum":"tipos_vidro","fumÃª":"tipos_vidro","verde":"tipos_vidro","laminado":"tipos_vidro",
  "box":"box","banheiro":"box","blindex":"box",
  "porta":"porta","janela":"porta",
  "telefone":"contato","whatsapp":"contato","contato":"contato"
};

function handleMessage(text){
  const lower=text.toLowerCase();
  const medida=findMeasurement(text);
  if(medida){
    let tipo=null;
    for(const t in pricePerM2){if(lower.includes(t)){tipo=t;break;}}
    if(!tipo)return showTyping(()=>addMessage("NÃ£o especificou tipo de vidro. Escolha temperado, comum ou fumÃª."),500);
    const area=(medida.w/100)*(medida.h/100);
    const total=(area*pricePerM2[tipo]).toFixed(2);
    return showTyping(()=>addMessage(`ðŸ“ OrÃ§amento aproximado:\nTipo: ${tipo.toUpperCase()}\nLargura: ${medida.w} cm\nAltura: ${medida.h} cm\nPreÃ§o: R$ ${total}`,'bot'),700);
  }
  for(const key in mapaRespostas){
    if(lower.includes(key)){
      const intent=mapaRespostas[key];
      return showTyping(()=>addMessage(respostas[intent][Math.floor(Math.random()*respostas[intent].length)],'bot'),500);
    }
  }
  showTyping(()=>addMessage(respostas.fallback[Math.floor(Math.random()*respostas.fallback.length)],'bot'),500);
}

function sendMessage(){
  const v=inputChat.value.trim();
  if(!v)return;
  addMessage(v,'user');
  inputChat.value='';
  handleMessage(v);
}
inputChat.addEventListener('keydown',e=>{if(e.key==='Enter'){sendMessage();}});

// Mensagem de boas-vindas
window.addEventListener('load',()=>{showTyping(()=>addMessage("OlÃ¡! Sou o CRISMAR BOT ðŸ¤– â€” mande medidas em cm ou pergunte sobre tipos de vidro, box, portas ou contato.","bot"),700);});
</script>

</body>
</html>